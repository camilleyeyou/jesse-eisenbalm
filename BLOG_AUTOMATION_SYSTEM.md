# Blog Automation System
## Jesse A. Eisenbalm — AI-Powered Content Pipeline

---

## Overview

A standalone automation project that generates, reviews, and publishes SEO-optimised blog posts to `jesseaeisenbalm.com/blog` on a daily schedule. Content is generated by OpenAI, images by Gemini, and the final post is submitted to the existing blog API. A web dashboard provides visibility and control over the entire pipeline.

---

## System Architecture

```
┌─────────────────────────────────────────────────────────┐
│                      DASHBOARD                          │
│   Topic Queue │ Schedule │ Review Queue │ Post History   │
└──────────────────────────┬──────────────────────────────┘
                           │ triggers
                           ▼
              ┌────────────────────────┐
              │    SUPERVISOR AGENT    │  ← orchestrates all agents
              │       (GPT-4o)         │    validates final output
              └────┬───────────────────┘
                   │
       ┌───────────┼───────────────┐
       ▼           ▼               ▼
┌──────────┐ ┌──────────┐  ┌──────────────┐
│   SEO    │ │ REVISION │  │    IMAGE     │
│ CONTENT  │ │  AGENT   │  │  GENERATOR   │
│  AGENT   │ │ (GPT-4o) │  │   AGENT      │
│ (GPT-4o) │ └──────────┘  │  (Gemini)    │
└──────────┘               └──────────────┘
       │                          │
       └──────────────────────────┘
                    │ POST /api/posts
                    ▼
       Jesse A. Eisenbalm Blog API
       (jesse-eisenbalm-server.vercel.app)
                    │
                    ▼
            Supabase (posts table)
                    │
                    ▼
        jesseaeisenbalm.com/blog
```

---

## The Four Agents

### 1. SEO Content Generator Agent
**Model:** OpenAI GPT-4o
**Role:** Produces the first draft of each blog post

**Inputs:**
- Topic / keyword cluster (from scheduler or dashboard queue)
- Brand voice guidelines (see Brand Context below)
- List of existing post titles (to avoid repetition)
- Target word count (default: 800–1200 words)

**Outputs:**
- `title` — 50–60 characters, keyword-rich, brand-aligned
- `excerpt` — 150–160 characters, Google meta description
- `content` — Full HTML body (`<h2>`, `<p>`, `<ul>`, `<blockquote>`, etc.)
- `tags` — 2–4 relevant tags (e.g. `["mindfulness", "lip care", "ritual"]`)
- `slug` — URL-safe, SEO-friendly (auto-generated by API if omitted)

**System prompt focus:**
- Write in the brand voice: calm, minimal, human, slightly philosophical
- Include the target keyword naturally 3–5 times
- Use proper heading hierarchy (`<h2>` for sections, `<h3>` for subsections)
- End with a CTA linking to `https://jesseaeisenbalm.com` (the product)
- Never use AI-sounding filler phrases ("In today's fast-paced world...")

---

### 2. Revision Agent
**Model:** OpenAI GPT-4o
**Role:** Reviews the draft, scores it, and returns an improved version

**Checks performed:**
| Check | Target |
|---|---|
| Title length | 50–60 characters |
| Excerpt length | 150–160 characters |
| Keyword density | 1–2% (not stuffed) |
| Heading structure | H2 → H3 hierarchy correct |
| Brand voice | Calm, human, minimal |
| Readability | Flesch-Kincaid Grade 8–10 |
| CTA present | Link to product page |
| HTML validity | No malformed tags |

**Outputs:**
- Revised `title`, `excerpt`, `content`, `tags`
- `confidence_score` (0–100) — passed to Supervisor for publish/hold decision
- `revision_notes` — brief log of what was changed (for dashboard display)

**Rule:** If `confidence_score < 70`, Supervisor routes to human review queue instead of publishing.

---

### 3. Image Generator Agent
**Model:** Google Gemini (Imagen 3 via Vertex AI, or `gemini-2.0-flash-preview-image-generation`)
**Role:** Creates a cover image that matches the post's tone and brand aesthetic

**Inputs:**
- Post title
- Post excerpt
- Brand aesthetic prompt suffix (appended to every generation — see below)

**Brand aesthetic prompt suffix:**
```
Minimal, clean, luxury skincare aesthetic. Muted tones — off-white, warm beige,
soft black. No text overlays. Cinematic lighting. Product photography or abstract
natural texture. No people. 16:9 aspect ratio.
```

**Outputs:**
- Raw image buffer → uploaded to Supabase Storage bucket `post-images`
- Returns public URL → passed as `cover_image` in the final post payload

**Supabase Storage path:** `post-images/{slug}/cover.jpg`

---

### 4. Supervisor Agent
**Model:** OpenAI GPT-4o
**Role:** Orchestrates the full pipeline, validates output, makes publish/hold/discard decision

**Workflow it manages:**
1. Receive topic from scheduler or dashboard
2. Call SEO Content Generator → get draft
3. Call Revision Agent → get improved draft + confidence score
4. If `confidence_score >= 70`: call Image Generator → get cover image
5. Validate final payload against schema (all required fields present, lengths correct)
6. Decision:
   - `confidence_score >= 85` → **auto-publish** (POST to API with `published: true`)
   - `confidence_score 70–84` → **publish as draft** (POST with `published: false`), flag in dashboard
   - `confidence_score < 70` → **hold for human review**, do not POST
7. Log result to dashboard

**Supervisor also handles:**
- Retry logic (up to 2 retries if an agent fails)
- Error capture and dashboard notification
- Daily topic selection (pulls next topic from queue, or auto-generates a topic if queue is empty using brand keyword bank)

---

## Workflow — Step by Step

```
SCHEDULE TRIGGER (daily cron) or MANUAL TRIGGER (dashboard)
    │
    ▼
Supervisor: pick next topic from queue
    │
    ▼
SEO Content Generator: write draft
    │
    ▼
Revision Agent: review + score draft
    │
    ├── confidence < 70 ──► HOLD: add to human review queue
    │
    ▼
Image Generator: create cover image → upload to Supabase Storage
    │
    ▼
Supervisor: validate final payload
    │
    ├── confidence 70–84 ──► POST /api/posts { published: false }  (draft)
    │
    └── confidence 85+ ───► POST /api/posts { published: true }   (live)
    │
    ▼
Dashboard: log result (success / draft / held / error)
```

---

## API Integration

The system posts to the existing Jesse A. Eisenbalm blog API.

**Endpoint:** `POST https://jesse-eisenbalm-server.vercel.app/api/posts`
**Auth:** `x-api-key: {BLOG_API_KEY}` header

**Payload schema:**
```json
{
  "title": "Why Lip Balm Is the Last Human Ritual",
  "excerpt": "In a world of screens and algorithms, the simple act of applying lip balm has become a rare moment of genuine physical presence. Here's why it matters.",
  "content": "<h2>The Ritual</h2><p>...</p>",
  "author": "Jesse A. Eisenbalm",
  "cover_image": "https://kqyiauyahlmruyblxezp.supabase.co/storage/v1/object/public/post-images/why-lip-balm/cover.jpg",
  "tags": ["mindfulness", "ritual", "human connection"],
  "published": true
}
```

**Response:** `{ post: { id, slug, title, ... } }`

---

## Dashboard Features

### Topic Queue
- Add topics manually or bulk-import a CSV
- Mark topics as pending / in-progress / published / skipped
- Auto-generate topics from keyword bank when queue is empty

### Schedule
- Set daily run time (default: 6:00 AM)
- Enable / disable auto-publishing
- View next scheduled run

### Review Queue
- Posts held for human review (confidence < 70)
- Preview rendered post content
- Edit title / excerpt / content before approving
- One-click approve (publishes immediately) or discard

### Post History
- All generated posts with status, confidence score, revision notes
- Link to live post on jesseaeisenbalm.com
- Regenerate option (re-runs full pipeline with same topic)

---

## Brand Context (Injected into Every Agent)

```
Brand: Jesse A. Eisenbalm
Product: Premium limited-edition beeswax lip balm. Release 001. $8.99. Hand-numbered.
Mission: Keep humans human in an AI-driven world.
Ritual: Stop. Breathe. Balm.
Tone: Calm. Minimal. Philosophical. Never corporate. Never hyperbolic.
Audience: Thoughtful adults who value mindfulness, quality, and intentional living.
Avoid: AI buzzwords, excessive exclamation points, hollow wellness clichés.
CTA target: https://jesseaeisenbalm.com
```

---

## Keyword Bank (Seed Topics)

The Supervisor draws from this bank when the queue is empty:

- The science of beeswax and why it outperforms synthetic wax
- What lip care rituals look like across different cultures
- Why limited-edition products feel more meaningful
- The philosophy of "enough" in a world of excess
- How to build a morning ritual that actually sticks
- The connection between dry lips and dehydration
- What it means to give to charity through everyday purchases
- Staying present in meetings, on calls, in life
- Why natural ingredients matter more than ever
- The hidden cost of convenience culture

---

## Tech Stack Recommendation

| Layer | Technology |
|---|---|
| Runtime | Node.js 20+ |
| Agent orchestration | LangChain.js or custom async pipeline |
| Scheduler | `node-cron` |
| Dashboard backend | Express.js |
| Dashboard frontend | React + Tailwind (match brand style) or Next.js |
| OpenAI | `openai` npm package (GPT-4o) |
| Gemini | `@google/generative-ai` npm package |
| Image upload | `@supabase/supabase-js` → Storage bucket |
| Task/queue storage | Supabase `automation_queue` table (reuse existing project) |
| Logging | Supabase `automation_logs` table |
| Hosting | Vercel (dashboard frontend) + Vercel serverless (backend) |

---

## Supabase Tables (Add to Existing Project)

```sql
-- Topic queue
CREATE TABLE automation_queue (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  topic TEXT NOT NULL,
  keywords TEXT[],
  status TEXT DEFAULT 'pending', -- pending | in_progress | published | held | discarded
  created_at TIMESTAMPTZ DEFAULT now(),
  processed_at TIMESTAMPTZ
);

-- Run logs
CREATE TABLE automation_logs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  queue_id UUID REFERENCES automation_queue(id),
  post_id UUID REFERENCES posts(id),
  status TEXT NOT NULL, -- success | draft | held | error
  confidence_score INT,
  revision_notes TEXT,
  error_message TEXT,
  created_at TIMESTAMPTZ DEFAULT now()
);
```

---

## Environment Variables (New Project)

```env
# OpenAI
OPENAI_API_KEY=

# Google Gemini
GEMINI_API_KEY=

# Jesse A. Eisenbalm Blog API
BLOG_API_KEY=adb66a122a92b46278069f15d1d5b376103d80ea54745e0a29317896261cced8
BLOG_API_URL=https://jesse-eisenbalm-server.vercel.app

# Supabase (reuse existing project for queue + image storage)
SUPABASE_URL=https://kqyiauyahlmruyblxezp.supabase.co
SUPABASE_SERVICE_ROLE_KEY=

# Dashboard auth
DASHBOARD_PASSWORD=

# Schedule (cron syntax — default: 6am daily)
CRON_SCHEDULE=0 6 * * *

# Publishing threshold (0-100)
AUTO_PUBLISH_THRESHOLD=85
DRAFT_THRESHOLD=70
```

---

## Project Structure

```
jesse-eisenbalm-automation/
├── agents/
│   ├── supervisorAgent.js      # Orchestration logic
│   ├── contentAgent.js         # SEO Content Generator
│   ├── revisionAgent.js        # Revision + scoring
│   └── imageAgent.js           # Gemini image generation + Supabase upload
├── dashboard/
│   ├── src/                    # React dashboard
│   └── public/
├── services/
│   ├── blogApi.js              # POST /api/posts wrapper
│   ├── supabase.js             # Supabase client
│   └── scheduler.js            # node-cron setup
├── prompts/
│   ├── contentPrompt.js        # System + user prompts for content agent
│   ├── revisionPrompt.js       # Revision agent prompt
│   └── brandContext.js         # Shared brand context injected into all agents
├── .env
├── package.json
└── index.js                    # Entry point
```

---

## Getting Started (New Project Setup)

1. Create a new repo: `jesse-eisenbalm-automation`
2. Run `npm init -y`
3. Install dependencies:
   ```bash
   npm install openai @google/generative-ai @supabase/supabase-js node-cron express dotenv
   ```
4. Copy `.env` and fill in all keys
5. Add `automation_queue` and `automation_logs` tables to Supabase
6. Create a `post-images` bucket in Supabase Storage (set to public)
7. Run `node index.js` to start scheduler + dashboard server
8. Deploy to Vercel

---

## Security Notes

- `BLOG_API_KEY` only allows creating posts — it cannot read payments or customer data
- `DASHBOARD_PASSWORD` should be a strong passphrase (the dashboard exposes the publish controls)
- `SUPABASE_SERVICE_ROLE_KEY` has full DB access — never expose in frontend code
- All secrets stay server-side; the dashboard frontend communicates with the backend only
